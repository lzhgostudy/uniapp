`uni-app`使用vue的语法+小程序的标签和API

# 开发规范

为了实现多端兼容，综合考虑编译速度、运行性能等因素，`uni-app`约定了如下开发规范:
- 页面文件遵循Vue单文件组件规范
- 组件标签靠近小程序规范
- 接口能力靠近微信小程序规范，但需要将前缀`wx`替换为`uni`
- 数据绑定及事件处理同`Vue.js`规范，同时补充了App即页面的生命周期
- 为了兼容多端运行，建议使用flex布局进行开发

# 目录结构

一个uni-app工程，默认包含如下目录及文件：

```t
|-cloudfunction			云函数目录
|-components				符合vue组件规范的uni-app组件目录
	|-comp.vue
|-hybrid						存放本地网页的目录
|-platforms					存放各平台专用页面的目录
|-pages							业务页面文件存放的目录
|-static						存放应用引用静态资源的目录
|-wxcomponents			存放小程序组件的目录
|-main.js						Vue初始化入口文件
|-App.vue						应用配置，用来配置APP全局样式以及监听应用生命周期
|-manifest.json			配置应用名称、appid、logo、版本等打包信息
|-pages.json				配置页面路由、导航条、选项卡等页面信息
```

#### Tips

- 编译到任意平台时，`static`目录下的文件均会被打包进去，非`static`目录下的文件（vue、js、css）被引用到才被包含进去。
- `static`目录下的`js`文件不会被编译，如果里面有`es6`的代码，不经过转换直接运行，在手机端会报错
- css, less/scss 等资源同样不要放在`static`目录下，建议这些公用的资源放在`common`目录下。
- HbuilderX支持在根目录创建`ext.json, sitemap.json`文件。


## 资源路径说明
### 模板内引入静态资源

> `template`内引入静态资源，如`image, video` 等标签的`src`属性时，可以使用相对路径或绝对路径，形式如下:

```html
<!-- 绝对路径，/static 指根目录下的static目录，在cli目录中/static指src目录下的static目录 -->

<image class="logo" src="/static/logo.png" />
<image class="logo" src="@/static/logo.png" />
<!-- 相对路径 -->
<image class="logo" src="../../static/logo.png"></image>
```

**注意**

- `@`开头的绝对路径以及相对路径会经过base64转换规则校验
- 引入的静态资源在非h5平台，均不转为base64
- H5平台，小于4kb的资源会被转换为base64，其余不转
- 支付宝小程序组件内image标签不可使用相对路径


### js文件引入

> `js`文件或`script`标签内引入js文件时，可以使用相对路径和绝对路径：

```js
// 绝对路径，@指向项目根目录，在cli项目中@指向src目录
import add from '@/common/add.js'
// 相对路径
import add from '../../common/add.js'
```

**注意**
- js文件不支持使用`/`开头的方式引入


### css引入静态资源

> `css`文件或`style`标签内引入`css`文件时(scss、less文件同理)，可以使用相对路径或绝对路径

```css
/* 绝对路径 */
@import url('/common/uni.css');
@import url('@/common/uni.css');

/* 相对路径 */
@import url('../../common/uni.css');
```


> `css`文件或`style`标签引用的图片路径可以使用相对路径也可以使用绝对路径，需要注意的是，有些小程序端css文件不允许引用本地文件


```css
/* 绝对路径 */
background-image: url('/static/logo.png');
backgournd-image: url('@/static/logo.png');
/* 相对路径 */
background-image: url('../../static/logo.png');
```



## 运行环境判断

### 开发环境和生产环境

`uni-app`可通过`process.env.NODE_ENV`判断当前是开发环境还是生产环境。一般用于连接测试服务器或生产环境的动态切换。

cli模式下，是通行的编译环境处理方式。

```js
if(process.env.NODE_ENV === 'development') {
	console.log('开发环境')
}else {
	console.log('生产环境')
}
```

### 判断平台

平台判断有2种场景，一种是在编译期判断，一种是运行期判断。
- 编译期判断即条件编译，不同平台在编译出包后已经是不同的代码。
```js
// #ifdef H5
	alert('只有h5平台才有alert方法')
// #endif
```

如上代码只会编译到h5的发行包里，其他平台的包不会包含如上代码。

- 运行期判断是指代码已经打入包里，仍需要在运行期判断平台，此时可用`uni.getSystemInfoSync().platform`判断客户端环境是Android, IOS还是小程序开发工具（在百度小程序IDE，微信小程序IDE，支付宝小程序IDE中使用`uni.getSystemInfoSync().platform`返回值都是devtools）.


## 页面样式与布局
### 尺寸单位

uni-app支持的通用css单位包括px, rpx
- px即屏幕像素
- rpx即响应式px，一种根据屏幕宽度自适应的动态单位。以750宽的屏幕为基准，750rpx恰好为屏幕宽度。屏幕变宽，rpx实际显示效果会等比放大，但在App端和H5端屏幕宽度达到960px时，默认将按照375px的屏幕宽度进行计算。

### 样式导入

使用`@import`语句可以导入外联样式表，`@import`后跟需要导入的外联样式表的相对路径，用`;`表示语句结束。

```css
@import "../common/uni.scss";

.uni-card {
	box-shadow: none;
}
```


### 内联样式

框架组件上支持使用style, class属性来控制组件的样式。
- style: 静态的样式统一写到class中。style接收动态的样式，在运行时会进行解析，请尽量避免将静态的样式写进style中，以免影响渲染速度。
```html
<view :style="{color: color}"></view>
```

- class: 用于指定样式规则，其属性值是样式规则中类选择器名
```html
<view class="class-name"></view>
```

### 选择器
目前支持的选择器

|选择器|样例|描述|
|:-|:-|:-|
|.class|.intro|选择所有拥有class="intro"的组件|
|#id|#firstname|选择拥有id="firstname"的组件|
|element|view|选择所有view组件|
|element, element|view, checkbox|选择所有文档的view组件和所有的checkbox组件|
|::after|view::after|在view组件后边插入内容，**仅微信小程序和App生效**|
|::before|view::before|在view组件前边插入内容，**仅微信小程序和App生效**|

**注意：**
- 在uni-app中不能使用`*`选择器
- 微信小程序自定义组件中仅支持class选择器
- `page`相当于`body`节点，例如：
```css
<!-- 设置页面背景颜色，使用 scoped 会导致失效 -->
page {
	background-color: #ccc
}
```